---
epic: "前端现代化与后端集成"
status: "To Do"
version: 1.0
---

# Epic: 前端现代化与后端集成

## Epic Goal

将前端应用与我们最新重构的、安全的、分层的后端服务完全集成。同时，引入前端自动化测试，提升应用的整体质量和未来的开发效率。

## Epic Description

### 1. 系统上下文

*   **当前状态:** 前端应用 (`client/`) 仍然连接到旧的、未分层的后端 API 端点，并且其认证逻辑依赖于一个临时的、基于 JSON 的用户系统。应用缺乏任何形式的自动化测试。
*   **目标状态:** 一个完全与新后端（包括自托管认证、分层 API）集成的、经过测试的前端应用。

### 2. 增强细节

*   **将要添加/变更的内容:**
    1.  **集成 JWT 认证:** 重构前端的登录、注册流程，使其能够调用新的 `/api/users/login` 和 `/api/users/register` 端点，并在成功后安全地存储和使用 JWT。
    2.  **API 请求重构:** 更新所有的数据请求（获取书籍、保存进度、管理高亮等），使其：
        *   指向新的、受保护的后端 API 端点。
        *   在请求头中附加 `Authorization: Bearer <token>`。
    3.  **建立前端测试策略:** 引入 Vitest 和 React Testing Library，为关键的 UI 组件（如 `Reader` 和 `Dashboard`）和业务逻辑（如 `progressUtils`）编写单元和组件测试。

### Stories

1.  **故事四: 前端认证流程集成**
    *   **简介:** 更新前端应用以适配新的自托管 JWT 认证流程。用户应能通过新界面注册和登录，应用需管理 JWT 的存储和刷新。

2.  **故事五: 前端数据流重构与集成**
    *   **简介:** 将所有前端数据获取和提交的逻辑，从旧的 API 路径迁移到由“故事三”创建的、受认证保护的新 API 端点上。

3.  **故事六: 前端自动化测试**
    *   **简介:** 为项目配置 Vitest 和 React Testing Library。为 `Reader` 组件的核心交互功能和 `progressUtils` 中的关键逻辑编写单元/组件测试。

### 兼容性要求

*   `[x]` 在集成过程中，UI/UX 的变更应保持最小化，主要集中在数据流和认证逻辑的重构上。

### 完成定义 (Definition of Done)

*   `[x]` 所有三个故事都已完成并通过 QA。
*   `[x]` 前端应用完全通过新的后端 API 进行数据交互。
*   `[x]` 用户认证流程完全基于 JWT，不再有任何临时或硬编码的用户逻辑。
*   `[x]` 关键的前端组件被自动化测试覆盖。
